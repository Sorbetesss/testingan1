(function(){$.extend({bb_table_search:function(n,t,i,r){$(n).data("bb_table_search",{obj:t,searchMethod:i,clearSearchMethod:r})},bb_table_resize:function(n){var r=n.find(".col-resizer");if(r.length>0){var u=function(n){var r=$(this),t=r.closest("th");n?t.addClass("border-resize"):t.removeClass("border-resize");var i=t.index(),u=t.closest(".table-resize").find("tbody"),f=u.find("tr").each(function(){var t=$(this.children[i]);n?t.addClass("border-resize"):t.removeClass("border-resize")});return i},t=0,f=0,i=0,e=0;r.each(function(){$(this).drag(function(r){i=u.call(this,!0);var o=n.find("table colgroup col")[i].width;t=o?parseInt(o):$(this).closest("th").width();f=$(this).closest("table").width();e=r.clientX},function(r){n.find("table colgroup").each(function(n,u){var s=$(u).find("col")[i],o=r.clientX-e;s.width=t+o;n===0&&$(u).closest("table").width(f+o)})},function(){u.call(this,!1)})})}},bb_table_load:function(n,t){var r=$(n),i=r.find(".table-loader");t==="show"?i.addClass("show"):i.removeClass("show")},bb_table:function(n,t,i){var r=$(n),y=function(){r.find(".is-tips").tooltip({container:"body",title:function(){return $(this).text()}})},s=r.find(".btn-col"),p,h,o,u,f,c,e,l,a,v,w;if(!s.hasClass("init")){s.addClass("init");s.on("click",function(){var n=$(this).next();n.toggleClass("show")})}if(t==="fixTableHeader"){p=r.find(".table-fixed-header");h=r.find(".table-fixed-body");h.on("scroll",function(){var n=h.scrollLeft();p.scrollLeft(n)});if(o=r.find(".fixed-scroll"),o.length===1){for(u=o.prev();u.length===1;)if(u.hasClass("fixed-right")&&!u.hasClass("modified"))f=u.css("right"),f=f.replace("px",""),$.browser.versions.mac?f=parseFloat(f)-2+"px":$.browser.versions.mobile&&(f=parseFloat(f)-17+"px"),u.css({right:f}).addClass("modified"),u=u.prev();else break;$.browser.versions.mobile&&o.remove()}r.find(".col-resizer:last").remove();$.bb_table_resize(r)}else if(t==="init"){c=r.find(".table-cell.is-sort .table-text");e={unset:"点击升序",sortAsc:"点击降序",sortDesc:"取消排序"};c.each(function(){var t=$(this).parent().find(".fa:last"),n;t.length>0&&(n=e.unset,t.hasClass("fa-sort-asc")?n=e.sortAsc:t.hasClass("fa-sort-desc")&&(n=e.sortDesc),$(this).tooltip({container:"body",title:n}))});c.on("click",function(){var t=$(this),r=t.parent().find(".fa:last"),n="sortAsc",i,u;r.hasClass("fa-sort-asc")?n="sortDesc":r.hasClass("fa-sort-desc")&&(n="unset");i=$("#"+t.attr("aria-describedby"));i.length>0&&(u=i.find(".tooltip-inner"),u.html(e[n]),t.attr("data-original-title",e[n]))});l=r.find(".table-toolbar");a=0;l.length>0&&(a=l.height());v=function(){var o=$(this).position(),s=$(this).attr("data-field"),i=r.find('.table-filter-item[data-field="'+s+'"]'),n=$(this).closest("th"),f=n.outerWidth()+n.position().left-i.outerWidth()/2,t=0,e,u;n.hasClass("sortable")&&(t=24);n.hasClass("filterable")&&(t=t+12);e=n.closest("table").parent().scrollLeft();u=n.offset().left+n.outerWidth()-t+i.outerWidth()/2-$(window).width();t=t+e;u>0&&(f=f-u-16,$arrow=i.find(".card-arrow"),$arrow.css({left:"calc(50% - 0.5rem + "+(u+16)+"px)"}));i.css({top:o.top+a+50,left:f-t})};r.find(".filterable .fa-filter").on("click",function(){v.call(this)});y();r.children(".table-scroll").scroll(function(){r.find(".table-filter-item.show").each(function(){var n=$(this).attr("data-field"),t=r.find('.fa-filter[data-field="'+n+'"]')[0];v.call(t)})});$.bb_table_resize(r)}else{if(t==="width")return w=0,i?r.outerWidth(!0):$(window).outerWidth(!0);t==="tooltip"&&y()}}});$(function(){$(document).on("keyup",function(n){var i,t;n.key==="Enter"?(i=$(n.target).closest(".table-container"),t=i.data("bb_table_search"),t&&t.obj.invokeMethodAsync(t.searchMethod)):n.key==="Escape"&&(i=$(n.target).closest(".table-container"),t=i.data("bb_table_search"),t&&t.obj.invokeMethodAsync(t.clearSearchMethod))})})})(jQuery);